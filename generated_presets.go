package mont_arith

// TODO move this config out of the preset template (into the generator?)

type ArithPreset struct {
	AddModImpls  []arithFunc
	SubModImpls  []arithFunc
	MulMontImpls []arithFunc
}

func (a *ArithPreset) MaxLimbCount() uint {
	return uint(len(a.MulMontImpls))
}

// Preset same as default except it uses blst's go-asm impl of the arithmetic at 384bit widths
func Asm384Preset() ArithPreset {
	addModImpls := []arithFunc{
		AddModNonUnrolled64,
		AddModNonUnrolled128,
		AddModNonUnrolled192,
		AddModNonUnrolled256,
		AddModNonUnrolled320,
		AddMod384_asm,
		AddModNonUnrolled448,
		AddModNonUnrolled512,
		AddModNonUnrolled576,
		AddModNonUnrolled640,
		AddModNonUnrolled704,
		AddModNonUnrolled768,
		AddModNonUnrolled832,
		AddModNonUnrolled896,
		AddModNonUnrolled960,
		AddModNonUnrolled1024,
		AddModNonUnrolled1088,
		AddModNonUnrolled1152,
		AddModNonUnrolled1216,
		AddModNonUnrolled1280,
		AddModNonUnrolled1344,
		AddModNonUnrolled1408,
		AddModNonUnrolled1472,
		AddModNonUnrolled1536,
		AddModNonUnrolled1600,
		AddModNonUnrolled1664,
		AddModNonUnrolled1728,
		AddModNonUnrolled1792,
		AddModNonUnrolled1856,
		AddModNonUnrolled1920,
		AddModNonUnrolled1984,
		AddModNonUnrolled2048,
		AddModNonUnrolled2112,
		AddModNonUnrolled2176,
		AddModNonUnrolled2240,
		AddModNonUnrolled2304,
		AddModNonUnrolled2368,
		AddModNonUnrolled2432,
		AddModNonUnrolled2496,
		AddModNonUnrolled2560,
		AddModNonUnrolled2624,
		AddModNonUnrolled2688,
		AddModNonUnrolled2752,
		AddModNonUnrolled2816,
		AddModNonUnrolled2880,
		AddModNonUnrolled2944,
		AddModNonUnrolled3008,
		AddModNonUnrolled3072,
		AddModNonUnrolled3136,
		AddModNonUnrolled3200,
		AddModNonUnrolled3264,
		AddModNonUnrolled3328,
		AddModNonUnrolled3392,
		AddModNonUnrolled3456,
		AddModNonUnrolled3520,
		AddModNonUnrolled3584,
		AddModNonUnrolled3648,
		AddModNonUnrolled3712,
		AddModNonUnrolled3776,
		AddModNonUnrolled3840,
		AddModNonUnrolled3904,
		AddModNonUnrolled3968,
		AddModNonUnrolled4032,
		AddModNonUnrolled4096,
	}

	subModImpls := []arithFunc{
		SubModNonUnrolled64,
		SubModNonUnrolled128,
		SubModNonUnrolled192,
		SubModNonUnrolled256,
		SubModNonUnrolled320,
		SubMod384_asm,
		SubModNonUnrolled448,
		SubModNonUnrolled512,
		SubModNonUnrolled576,
		SubModNonUnrolled640,
		SubModNonUnrolled704,
		SubModNonUnrolled768,
		SubModNonUnrolled832,
		SubModNonUnrolled896,
		SubModNonUnrolled960,
		SubModNonUnrolled1024,
		SubModNonUnrolled1088,
		SubModNonUnrolled1152,
		SubModNonUnrolled1216,
		SubModNonUnrolled1280,
		SubModNonUnrolled1344,
		SubModNonUnrolled1408,
		SubModNonUnrolled1472,
		SubModNonUnrolled1536,
		SubModNonUnrolled1600,
		SubModNonUnrolled1664,
		SubModNonUnrolled1728,
		SubModNonUnrolled1792,
		SubModNonUnrolled1856,
		SubModNonUnrolled1920,
		SubModNonUnrolled1984,
		SubModNonUnrolled2048,
		SubModNonUnrolled2112,
		SubModNonUnrolled2176,
		SubModNonUnrolled2240,
		SubModNonUnrolled2304,
		SubModNonUnrolled2368,
		SubModNonUnrolled2432,
		SubModNonUnrolled2496,
		SubModNonUnrolled2560,
		SubModNonUnrolled2624,
		SubModNonUnrolled2688,
		SubModNonUnrolled2752,
		SubModNonUnrolled2816,
		SubModNonUnrolled2880,
		SubModNonUnrolled2944,
		SubModNonUnrolled3008,
		SubModNonUnrolled3072,
		SubModNonUnrolled3136,
		SubModNonUnrolled3200,
		SubModNonUnrolled3264,
		SubModNonUnrolled3328,
		SubModNonUnrolled3392,
		SubModNonUnrolled3456,
		SubModNonUnrolled3520,
		SubModNonUnrolled3584,
		SubModNonUnrolled3648,
		SubModNonUnrolled3712,
		SubModNonUnrolled3776,
		SubModNonUnrolled3840,
		SubModNonUnrolled3904,
		SubModNonUnrolled3968,
		SubModNonUnrolled4032,
		SubModNonUnrolled4096,
	}
	mulMontImpls := []arithFunc{
		mulMont64,
		mulMont128,
		mulMont192,
		mulMont256,
		mulMont320,
		MulMont384_asm,
		mulMont448,
		mulMont512,
		mulMont576,
		mulMont640,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
	}

	return ArithPreset{addModImpls, subModImpls, mulMontImpls}
}

func DefaultPreset() ArithPreset {
	addModImpls := []arithFunc{
		AddModNonUnrolled64,
		AddModNonUnrolled128,
		AddModNonUnrolled192,
		AddModNonUnrolled256,
		AddModNonUnrolled320,
		AddModNonUnrolled384,
		AddModNonUnrolled448,
		AddModNonUnrolled512,
		AddModNonUnrolled576,
		AddModNonUnrolled640,
		AddModNonUnrolled704,
		AddModNonUnrolled768,
		AddModNonUnrolled832,
		AddModNonUnrolled896,
		AddModNonUnrolled960,
		AddModNonUnrolled1024,
		AddModNonUnrolled1088,
		AddModNonUnrolled1152,
		AddModNonUnrolled1216,
		AddModNonUnrolled1280,
		AddModNonUnrolled1344,
		AddModNonUnrolled1408,
		AddModNonUnrolled1472,
		AddModNonUnrolled1536,
		AddModNonUnrolled1600,
		AddModNonUnrolled1664,
		AddModNonUnrolled1728,
		AddModNonUnrolled1792,
		AddModNonUnrolled1856,
		AddModNonUnrolled1920,
		AddModNonUnrolled1984,
		AddModNonUnrolled2048,
		AddModNonUnrolled2112,
		AddModNonUnrolled2176,
		AddModNonUnrolled2240,
		AddModNonUnrolled2304,
		AddModNonUnrolled2368,
		AddModNonUnrolled2432,
		AddModNonUnrolled2496,
		AddModNonUnrolled2560,
		AddModNonUnrolled2624,
		AddModNonUnrolled2688,
		AddModNonUnrolled2752,
		AddModNonUnrolled2816,
		AddModNonUnrolled2880,
		AddModNonUnrolled2944,
		AddModNonUnrolled3008,
		AddModNonUnrolled3072,
		AddModNonUnrolled3136,
		AddModNonUnrolled3200,
		AddModNonUnrolled3264,
		AddModNonUnrolled3328,
		AddModNonUnrolled3392,
		AddModNonUnrolled3456,
		AddModNonUnrolled3520,
		AddModNonUnrolled3584,
		AddModNonUnrolled3648,
		AddModNonUnrolled3712,
		AddModNonUnrolled3776,
		AddModNonUnrolled3840,
		AddModNonUnrolled3904,
		AddModNonUnrolled3968,
		AddModNonUnrolled4032,
		AddModNonUnrolled4096,
	}

	subModImpls := []arithFunc{
		SubModNonUnrolled64,
		SubModNonUnrolled128,
		SubModNonUnrolled192,
		SubModNonUnrolled256,
		SubModNonUnrolled320,
		SubModNonUnrolled384,
		SubModNonUnrolled448,
		SubModNonUnrolled512,
		SubModNonUnrolled576,
		SubModNonUnrolled640,
		SubModNonUnrolled704,
		SubModNonUnrolled768,
		SubModNonUnrolled832,
		SubModNonUnrolled896,
		SubModNonUnrolled960,
		SubModNonUnrolled1024,
		SubModNonUnrolled1088,
		SubModNonUnrolled1152,
		SubModNonUnrolled1216,
		SubModNonUnrolled1280,
		SubModNonUnrolled1344,
		SubModNonUnrolled1408,
		SubModNonUnrolled1472,
		SubModNonUnrolled1536,
		SubModNonUnrolled1600,
		SubModNonUnrolled1664,
		SubModNonUnrolled1728,
		SubModNonUnrolled1792,
		SubModNonUnrolled1856,
		SubModNonUnrolled1920,
		SubModNonUnrolled1984,
		SubModNonUnrolled2048,
		SubModNonUnrolled2112,
		SubModNonUnrolled2176,
		SubModNonUnrolled2240,
		SubModNonUnrolled2304,
		SubModNonUnrolled2368,
		SubModNonUnrolled2432,
		SubModNonUnrolled2496,
		SubModNonUnrolled2560,
		SubModNonUnrolled2624,
		SubModNonUnrolled2688,
		SubModNonUnrolled2752,
		SubModNonUnrolled2816,
		SubModNonUnrolled2880,
		SubModNonUnrolled2944,
		SubModNonUnrolled3008,
		SubModNonUnrolled3072,
		SubModNonUnrolled3136,
		SubModNonUnrolled3200,
		SubModNonUnrolled3264,
		SubModNonUnrolled3328,
		SubModNonUnrolled3392,
		SubModNonUnrolled3456,
		SubModNonUnrolled3520,
		SubModNonUnrolled3584,
		SubModNonUnrolled3648,
		SubModNonUnrolled3712,
		SubModNonUnrolled3776,
		SubModNonUnrolled3840,
		SubModNonUnrolled3904,
		SubModNonUnrolled3968,
		SubModNonUnrolled4032,
		SubModNonUnrolled4096,
	}
	mulMontImpls := []arithFunc{
		mulMont64,
		mulMont128,
		mulMont192,
		mulMont256,
		mulMont320,
		mulMont384,
		mulMont448,
		mulMont512,
		mulMont576,
		mulMont640,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
	}

	return ArithPreset{addModImpls, subModImpls, mulMontImpls}
}

func MulMontNonInterleavedPreset() ArithPreset {
	addModImpls := []arithFunc{
		AddModNonUnrolled64,
		AddModNonUnrolled128,
		AddModNonUnrolled192,
		AddModNonUnrolled256,
		AddModNonUnrolled320,
		AddModNonUnrolled384,
		AddModNonUnrolled448,
		AddModNonUnrolled512,
		AddModNonUnrolled576,
		AddModNonUnrolled640,
		AddModNonUnrolled704,
		AddModNonUnrolled768,
		AddModNonUnrolled832,
		AddModNonUnrolled896,
		AddModNonUnrolled960,
		AddModNonUnrolled1024,
		AddModNonUnrolled1088,
		AddModNonUnrolled1152,
		AddModNonUnrolled1216,
		AddModNonUnrolled1280,
		AddModNonUnrolled1344,
		AddModNonUnrolled1408,
		AddModNonUnrolled1472,
		AddModNonUnrolled1536,
		AddModNonUnrolled1600,
		AddModNonUnrolled1664,
		AddModNonUnrolled1728,
		AddModNonUnrolled1792,
		AddModNonUnrolled1856,
		AddModNonUnrolled1920,
		AddModNonUnrolled1984,
		AddModNonUnrolled2048,
		AddModNonUnrolled2112,
		AddModNonUnrolled2176,
		AddModNonUnrolled2240,
		AddModNonUnrolled2304,
		AddModNonUnrolled2368,
		AddModNonUnrolled2432,
		AddModNonUnrolled2496,
		AddModNonUnrolled2560,
		AddModNonUnrolled2624,
		AddModNonUnrolled2688,
		AddModNonUnrolled2752,
		AddModNonUnrolled2816,
		AddModNonUnrolled2880,
		AddModNonUnrolled2944,
		AddModNonUnrolled3008,
		AddModNonUnrolled3072,
		AddModNonUnrolled3136,
		AddModNonUnrolled3200,
		AddModNonUnrolled3264,
		AddModNonUnrolled3328,
		AddModNonUnrolled3392,
		AddModNonUnrolled3456,
		AddModNonUnrolled3520,
		AddModNonUnrolled3584,
		AddModNonUnrolled3648,
		AddModNonUnrolled3712,
		AddModNonUnrolled3776,
		AddModNonUnrolled3840,
		AddModNonUnrolled3904,
		AddModNonUnrolled3968,
		AddModNonUnrolled4032,
		AddModNonUnrolled4096,
	}

	subModImpls := []arithFunc{
		SubModNonUnrolled64,
		SubModNonUnrolled128,
		SubModNonUnrolled192,
		SubModNonUnrolled256,
		SubModNonUnrolled320,
		SubModNonUnrolled384,
		SubModNonUnrolled448,
		SubModNonUnrolled512,
		SubModNonUnrolled576,
		SubModNonUnrolled640,
		SubModNonUnrolled704,
		SubModNonUnrolled768,
		SubModNonUnrolled832,
		SubModNonUnrolled896,
		SubModNonUnrolled960,
		SubModNonUnrolled1024,
		SubModNonUnrolled1088,
		SubModNonUnrolled1152,
		SubModNonUnrolled1216,
		SubModNonUnrolled1280,
		SubModNonUnrolled1344,
		SubModNonUnrolled1408,
		SubModNonUnrolled1472,
		SubModNonUnrolled1536,
		SubModNonUnrolled1600,
		SubModNonUnrolled1664,
		SubModNonUnrolled1728,
		SubModNonUnrolled1792,
		SubModNonUnrolled1856,
		SubModNonUnrolled1920,
		SubModNonUnrolled1984,
		SubModNonUnrolled2048,
		SubModNonUnrolled2112,
		SubModNonUnrolled2176,
		SubModNonUnrolled2240,
		SubModNonUnrolled2304,
		SubModNonUnrolled2368,
		SubModNonUnrolled2432,
		SubModNonUnrolled2496,
		SubModNonUnrolled2560,
		SubModNonUnrolled2624,
		SubModNonUnrolled2688,
		SubModNonUnrolled2752,
		SubModNonUnrolled2816,
		SubModNonUnrolled2880,
		SubModNonUnrolled2944,
		SubModNonUnrolled3008,
		SubModNonUnrolled3072,
		SubModNonUnrolled3136,
		SubModNonUnrolled3200,
		SubModNonUnrolled3264,
		SubModNonUnrolled3328,
		SubModNonUnrolled3392,
		SubModNonUnrolled3456,
		SubModNonUnrolled3520,
		SubModNonUnrolled3584,
		SubModNonUnrolled3648,
		SubModNonUnrolled3712,
		SubModNonUnrolled3776,
		SubModNonUnrolled3840,
		SubModNonUnrolled3904,
		SubModNonUnrolled3968,
		SubModNonUnrolled4032,
		SubModNonUnrolled4096,
	}
	mulMontImpls := []arithFunc{
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
		MulMontNonInterleaved,
	}

	return ArithPreset{addModImpls, subModImpls, mulMontImpls}
}
